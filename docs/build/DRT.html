<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DRT · EISAnalysis.jl</title><meta name="title" content="DRT · EISAnalysis.jl"/><meta property="og:title" content="DRT · EISAnalysis.jl"/><meta property="twitter:title" content="DRT · EISAnalysis.jl"/><meta name="description" content="Documentation for EISAnalysis.jl."/><meta property="og:description" content="Documentation for EISAnalysis.jl."/><meta property="twitter:description" content="Documentation for EISAnalysis.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">EISAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Index</a></li><li><a class="tocitem" href="Tutorial.html">Tutorial</a></li><li class="is-active"><a class="tocitem" href="DRT.html">DRT</a></li><li><a class="tocitem" href="api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="DRT.html">DRT</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="DRT.html">DRT</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bdamerau/EISAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bdamerau/EISAnalysis.jl/blob/main/docs/src/DRT.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Calculating-DRT"><a class="docs-heading-anchor" href="#Calculating-DRT">Calculating DRT</a><a id="Calculating-DRT-1"></a><a class="docs-heading-anchor-permalink" href="#Calculating-DRT" title="Permalink"></a></h1><p>This package estimates DRT by generating a Voigt circuit model and fitting its parameters using <code>LsqFit.jl</code>. The concept can be broken down simply: any impedance <span>$Z(\omega)$</span> can be generated by a series of RC pairs: $ Z(\omega) = \sum<em>i^\infty \frac{R</em>i}{1+i\omega\tau<em>i},\ \tau</em>i = R<em>iC</em>i $ This is analogous to a fourier transform for generic functions. Let&#39;s look at some examples.</p><pre><code class="language-julia hljs">using EISAnalysis</code></pre><p>First, let&#39;s consider a simple circuit with 2 RC pairs</p><pre><code class="language-julia hljs">rc_circuit = r/c-1.2r/5c
plot_Nyquist(rc_circuit)</code></pre><p><img src="pics/DRT_files/DRT_4_0.png" alt/></p><p>You can fit this to a Voigt circuit and estimate the DRT. The expanded fit includes the individual contribution from each RC pair in the Voigt circuit model and acts as a visual aid in interpreting the DRT plot.</p><pre><code class="language-julia hljs">rc_fit = compute_drt(rc_circuit.ω,rc_circuit.Z)</code></pre><p><img src="pics/DRT_files/DRT_6_0.png" alt/></p><pre><code class="nohighlight hljs">Dict{String, Any} with 4 entries:
  &quot;Z&quot;   =&gt; ComplexF64[3.94376e-5-0.000121343im, 5.13126e-5-0.000157868im, 6.676…
  &quot;τ&quot;   =&gt; LogRange{Float64}(1.0e-6, 10000.0, 70)
  &quot;R0&quot;  =&gt; 1.80035e-6
  &quot;drt&quot; =&gt; [1.7049e-5, 7.79661e-7, 9.44932e-7, 1.6376e-5, 0.0, 2.68542e-5, 8.40…</code></pre><p>Now for more complicated circuits, it is helpful to employ Tikhonov regularization to decouple parameters. However, one has to be carefel when interpreting this data. Notice the high frequency (low timescale) bump in the fit as well as the DRT. This is an artifact from the regularization method. It&#39;s always helpful to see the results both with and without regularization to check for such artifacts.</p><p>In general, computing the DRT is problematic when the EIS frequency range is too narrow and the Nyquist plot is not fully resolved (especially on the high frequency end). In such cases it is safer to use <code>circuit_fit</code>.</p><pre><code class="language-julia hljs">randles_circuit = 0.23r-(r-0.025ws^80)/0.2q
randles_fit = compute_drt(randles_circuit.ω,randles_circuit.Z;regularization=true)</code></pre><pre><code class="nohighlight hljs">Regularization
--------------
λ = 9.999999999999999e-5
rtol = 0.0005431364784255923</code></pre><p><img src="pics/DRT_files/DRT_10_1.png" alt/></p><pre><code class="nohighlight hljs">Dict{String, Any} with 4 entries:
  &quot;Z&quot;   =&gt; ComplexF64[0.225575-0.0277721im, 0.228226-0.0205447im, 0.229664-0.01…
  &quot;τ&quot;   =&gt; LogRange{Float64}(1.0e-6, 10000.0, 70)
  &quot;R0&quot;  =&gt; 0.0648194
  &quot;drt&quot; =&gt; [0.150936, 0.133404, 0.108899, 0.075177, 0.0303512, 0.0, 0.0, 0.0, 0…</code></pre><p>With this experimental EIS data from Mendeley, the issue discussed above is further demonstrated. </p><pre><code class="language-julia hljs">using CSV,DataFrames,Plots
ω_exp =  [ 0.05, 0.1, 0.2, 0.4, 1, 2, 4, 10, 20, 40, 100, 200, 400, 1000]
data = CSV.read(&quot;Data/EIS_Data.csv&quot;,DataFrame)
Z_exp = data[!,&quot;Re(Z)&quot;]-im*data[!,&quot;-Im(Z)&quot;]
plt =scatter(Z_exp,label = &quot;data&quot;,aspect_ratio=:equal)
plot!(plt,ylims = (-0.01,0),yflip=true)</code></pre><p><img src="pics/DRT_files/DRT_12_0.png" alt/></p><p>Without using regularization we may have a good DRT firt but may wish to use regularization to decouple the parameters and generate a smoother function. However the drt computed with regularization generates a model that does not fit at all to the original data set. This is principally owed to the unresolved feature of the original Nyquist plot in the high frequency range. In this case it could me more useful to fit the data to a circuit model like a Randles circuit.</p><pre><code class="language-julia hljs">fit = compute_drt(ω_exp,Z_exp)
regularized_fit = compute_drt(ω_exp,Z_exp;regularization=true)</code></pre><pre><code class="nohighlight hljs">rtol = 5.899319460523529e-7
Regularization
--------------
λ = 0.01
rtol = 0.0008280857326777196</code></pre><p><img src="pics/DRT_files/DRT_14_1.png" alt/> <img src="pics/DRT_files/DRT_14_2.png" alt/></p><pre><code class="nohighlight hljs">Dict{String, Any} with 4 entries:
  &quot;Z&quot;   =&gt; ComplexF64[0.0706284-0.00414218im, 0.0692506-0.00274757im, 0.0686266…
  &quot;τ&quot;   =&gt; LogRange{Float64}(0.0001, 200.0, 42)
  &quot;R0&quot;  =&gt; 0.0124534
  &quot;drt&quot; =&gt; [0.0293391, 0.0267395, 0.022969, 0.0175789, 0.0102225, 0.00129367, 0…</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="Tutorial.html">« Tutorial</a><a class="docs-footer-nextpage" href="api.html">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 24 February 2025 21:25">Monday 24 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
